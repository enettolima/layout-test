<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>Bonsai 01</title>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/bonsai/0.4/bonsai.min.js" type="text/javascript" charset="utf-8"></script>
    </head>
    <style type="text/css" media="all">
        .scale-time {
            font-size:11px;
            text-align:right;
            padding-right:2px;
            line-height:16px;
            font-family:monospace;
        }
    </style>
    <body>
        <!-- width = blockwidth * 11 * 7 -->
        <!-- height = blockheight * 4 * 24 -->
        <div id="scale" style="float:left; height:768px; width:54px;">
            <div class="scale-time">12:00am</div>
            <div class="scale-time">12:30am</div>

            <div class="scale-time">1:00am</div>
            <div class="scale-time">1:30am</div>

            <div class="scale-time">2:00am</div>
            <div class="scale-time">2:30am</div>

            <div class="scale-time">3:00am</div>
            <div class="scale-time">3:30am</div>

            <div class="scale-time">4:00am</div>
            <div class="scale-time">4:30am</div>

            <div class="scale-time">5:00am</div>
            <div class="scale-time">5:30am</div>

            <div class="scale-time">6:00am</div>
            <div class="scale-time">6:30am</div>

            <div class="scale-time">7:00am</div>
            <div class="scale-time">7:30am</div>

            <div class="scale-time">8:00am</div>
            <div class="scale-time">8:30am</div>

            <div class="scale-time">9:00am</div>
            <div class="scale-time">9:30am</div>

            <div class="scale-time">10:00am</div>
            <div class="scale-time">10:30am</div>

            <div class="scale-time">11:00am</div>
            <div class="scale-time">11:30am</div>

            <div class="scale-time">12:00pm</div>
            <div class="scale-time">12:30pm</div>

            <div class="scale-time">1:00pm</div>
            <div class="scale-time">1:30pm</div>

            <div class="scale-time">2:00pm</div>
            <div class="scale-time">2:30pm</div>

            <div class="scale-time">3:00pm</div>
            <div class="scale-time">3:30pm</div>

            <div class="scale-time">4:00pm</div>
            <div class="scale-time">4:30pm</div>

            <div class="scale-time">5:00pm</div>
            <div class="scale-time">5:30pm</div>

            <div class="scale-time">6:00pm</div>
            <div class="scale-time">6:30pm</div>

            <div class="scale-time">7:00pm</div>
            <div class="scale-time">7:30pm</div>

            <div class="scale-time">8:00pm</div>
            <div class="scale-time">8:30pm</div>

            <div class="scale-time">9:00pm</div>
            <div class="scale-time">9:30pm</div>

            <div class="scale-time">10:00pm</div>
            <div class="scale-time">10:30pm</div>

            <div class="scale-time">11:00pm</div>
            <div class="scale-time">11:30pm</div>
        </div>
        <div id="movie" style="background:#efefef; margin-left:54px; width:924px; height:768px"></div>
        <script type="text/javascript" charset="utf-8">

            bonsai.run(document.getElementById('movie'), {
                code: function() {

                    var sunday = [];
                    sunday.push( { 'eid': '301SM', 'inouts': [ 
                        {'in':'00:00', 'out':'00:30'}, 
                        {'in':'01:00', 'out':'01:30'}, 
                        {'in':'02:00', 'out':'02:30'}, 
                        {'in':'03:00', 'out':'03:30'}, 
                        {'in':'04:00', 'out':'04:30'}, 
                        {'in':'05:00', 'out':'05:30'}, 
                        {'in':'06:00', 'out':'06:30'}, 
                        {'in':'07:00', 'out':'07:30'}, 
                        {'in':'08:00', 'out':'08:30'}, 
                        {'in':'09:00', 'out':'09:30'}, 
                        {'in':'10:00', 'out':'10:30'}, 
                        {'in':'11:00', 'out':'11:30'}, 
                        {'in':'12:00', 'out':'12:30'}, 
                        {'in':'13:00', 'out':'13:30'}, 
                        {'in':'14:00', 'out':'14:30'}, 
                        {'in':'15:00', 'out':'15:30'}, 
                        {'in':'16:00', 'out':'16:30'}, 
                        {'in':'17:00', 'out':'17:30'}, 
                        {'in':'18:00', 'out':'18:30'}, 
                        {'in':'19:00', 'out':'19:30'}, 
                        {'in':'20:00', 'out':'20:30'}, 
                        {'in':'21:00', 'out':'21:30'}, 
                        {'in':'22:00', 'out':'22:30'}, 
                        {'in':'23:00', 'out':'23:30'}, 
                    ] });
                    sunday.push( { 'eid': '301LB', 'inouts': [ {'in':'09:00', 'out':'10:00'}, {'in':'13:00', 'out':'22:00'} ] });
                    sunday.push( { 'eid': '301SR', 'inouts': [ {'in':'09:00', 'out':'10:30'}, {'in':'13:00', 'out':'20:15'} ] }); 

                    var monday = [];
                    monday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    monday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    monday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var tuesday = [];
                    tuesday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    tuesday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    tuesday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var wednesday = [];
                    wednesday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    wednesday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    wednesday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var thursday = [];
                    thursday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    thursday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    thursday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var friday = [];
                    friday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    friday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    friday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var saturday = [];
                    saturday.push( { 'eid': '301SM', 'inouts': [ {'in':'11:00', 'out':'14:00'}, {'in':'15:00', 'out':'19:00'} ] });
                    saturday.push( { 'eid': '301LB', 'inouts': [ {'in':'08:00', 'out':'12:30'}, {'in':'13:00', 'out':'22:00'} ] });
                    saturday.push( { 'eid': '301SR', 'inouts': [ {'in':'07:30', 'out':'11:00'}, {'in':'12:00', 'out':'18:00'} ] });

                    var days = [sunday, monday, tuesday, wednesday, thursday, friday, saturday]; 

                    // console.log(days);

                    var startX = 0;
                    var startY = 0;
                    var blockWidth = 12;
                    var blockHeight = 8;
                    var alpha = 1;
                    var dayWidth = blockWidth * 10;

                    var colors = [
                        new color.RGBAColor(42,75,215,alpha),
                        new color.RGBAColor(129,197,122,alpha),
                        new color.RGBAColor(173,35,35,alpha),
                    ]; 

                    var myColor = new color.RGBAColor(42,75,215,alpha);

                    for(var dayIterator=0; dayIterator < days.length; dayIterator++){

                        var dayStartX = dayWidth * dayIterator;

                        var day = days[dayIterator];

                        for (var empIterator=0; empIterator < days[dayIterator].length; empIterator++) {

                            var empStartX = dayStartX + (blockWidth * empIterator);

                            var emp = days[dayIterator][empIterator];

                            var inoutStartY = 0;

                            var dayStart = new Date(2000, 0, 1, 0, 0, 0);
                            var accumulatedPaddingBlocks = 0;

                            for(var inoutIterator=0; inoutIterator < emp['inouts'].length; inoutIterator++) {
                                var inoutStartX = dayStartX + empStartX;
                                inout = emp['inouts'][inoutIterator];
                                var clockInParts  = inout['in'].match(/^(\d+):(\d+)$/);
                                var clockIn = new Date(2000, 0, 1, parseInt(clockInParts[1]), parseInt(clockInParts[2]), 0);

                                var clockOutParts = inout['out'].match(/^(\d+):(\d+)$/);
                                var clockOut = new Date(2000, 0, 1, parseInt(clockOutParts[1]), parseInt(clockOutParts[2]), 0);

                                inOutBlockCount = ((clockOut - clockIn) / 1000 / 60 / 60) * 4;

                                var padBlockCount = ((clockIn - dayStart) / 1000 / 60 / 60) * 4;

                                inoutStartY = padBlockCount * blockHeight;

                                inoutStartY = inoutStartY + (accumulatedPaddingBlocks * blockHeight);

                                new Rect(
                                        empStartX,
                                        inoutStartY,
                                        blockWidth,
                                        inOutBlockCount*blockHeight
                                    )
                                    .addTo(stage)
                                    .attr('fillColor', colors[empIterator]);

                            }
                        }
                    }
                },

                width: 924,

                height: 768 
            });
        </script>
    </body>
</html>
